@startuml
skinparam componentStyle uml2

package "UI Layer (Presentation)" {
    component MainActivity
    component AuthActivity

    package "Fragments" {
        [RunFragment]
        [ListFragment]
        [DetailFragment]
        [LoginFragment]
        [RegisterFragment]
    }
}

package "Service Layer" {
    [RunService] <<Foreground Service>>
}

package "Domain Layer" {
    [Run] <<Data Model>>
    [Feedback] <<Data Model>>
    [RunUtils] <<Utility>>
}

package "Data Layer (Firebase)" {
    database "Firestore" as DB
    database "Firebase Auth" as Auth
}

package "Infrastructure / SDK" {
    [Google Maps SDK]
    [Play Services Location]
}

' Interactions
MainActivity -down-> [RunFragment] : Navigation
MainActivity -down-> [ListFragment] : Navigation
MainActivity -down-> [DetailFragment] : Navigation
AuthActivity -down-> [LoginFragment] : Navigation
AuthActivity -down-> [RegisterFragment] : Navigation

[RunFragment] ..> [RunService] : "Binds / Observes LiveData"
[RunService] -right-> [Play Services Location] : "Get Updates"
[RunService] ..> [Run] : "Creates"
[RunService] -down-> DB : "Save Run"

[ListFragment] -down-> DB : "Fetch Runs"
[DetailFragment] -down-> DB : "Fetch Run details"

[RunFragment] -right-> [Google Maps SDK] : "Draw Polyline"
[DetailFragment] -right-> [Google Maps SDK] : "Draw Polyline"

[RunUtils] <.. [RunService] : "Calculates Distance/Speed"
[RunUtils] <.. [RunFragment] : "Format UI"
[RunUtils] <.. [DetailFragment] : "Format UI"

AuthActivity -down-> Auth : "Login/Register"
MainActivity -down-> Auth : "Check Session"

@enduml